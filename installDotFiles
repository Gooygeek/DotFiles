#!/bin/bash

{ # try
    echo "Started installation"
    echo "Backing up current settings"
    if [ ! -f ~/.bashrc.backup ]; then
        mv ~/.bashrc ~/.bashrc.backup
    fi
    if [ ! -f ~/.bash_profile.backup ]; then
        mv ~/.bash_profile ~/.bash_profile.backup
    fi
    if [ ! -d ~/.config.backup ]; then
        mkdir ~/.config.backup
        cp -rf ~/.config/* ~/.config.backup/
    fi
    echo "Copying configs"
    cp -rf .vimrc ~/
    cp -rf .vim ~/
    cp -rf .tmux.conf ~/
    cp -rf .tmux ~/
    cp -rf .gitconfig ~/
    cp -rf .gitmessage ~/
    cp -rf .bash_custom ~/
    cp -rf .bash.d ~/
    cp -rf .local/bin ~/
    cp -rf .config ~
    echo "Generating default files"
    echo ". ~/.bashrc" >| ~/.bash_profile
    cat >| ~/.bashrc << EOF
if [ -f ~/.bash_custom ]; then
    . ~/.bash_custom
fi
EOF
    cat >| ~/.zshrc << EOF
for file in ~/.config/zsh/*.zsh; do
    . \$file
done

eval "\$(starship init zsh)"
EOF
} || { # Catch
echo "Something went wrong"
}
